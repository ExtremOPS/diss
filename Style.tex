\usepackage{fix-cm}
\usepackage{titlesec}
% \titleformat{\chapter}[display]
% {\bfseries\LARGE}
% {\vspace{-4ex}\selectfont\color{lightgray}\hfill
%   \Large\textrm{\chaptertitlename}
%   \fontsize{85}{70}\textbf{\thechapter}}
% {4ex}
% {}
% [\vspace{1ex}\titlerule]

\colorlet{chaptercolor}{blue!80!black}

\setkomafont{chapter}{\normalfont\color{chaptercolor}\huge}
\setkomafont{chapterprefix}{\Large}
\renewcommand*{\raggedchapter}{\raggedleft}
\renewcommand*{\chapterformat}{%
  \MakeUppercase{\chapappifchapterprefix{}}%
  \rlap{\enskip\resizebox{!}{1.2cm}{\thechapter} \rule{15cm}{1.2cm} }%
}
\RedeclareSectionCommand[beforeskip=30pt,afterskip=20pt]{chapter}
\renewcommand*\chapterheadmidvskip{\par\nobreak\vspace{10pt}}

\titleformat{\section}
{\normalfont\bfseries\Large}
{\thesection.}{0.5em}{}

\titleformat{\subsection}
{\normalfont\bfseries\normalsize}
{\thesubsection.}{0.5em}{}

\usepackage{fancyhdr}

\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyfoot[OR]{\textbf{\thepage}}%
  \renewcommand{\headrulewidth}{0pt}% Line at the header invisible
  \renewcommand{\footrulewidth}{0pt}% Line at the footer visible
}

\pagestyle{fancy}
\fancyfoot{}
\fancyhead{}
\renewcommand{\chaptermark}[1]{
  \markboth{\chaptername\ \thechapter\ --\ #1}{}}
\renewcommand{\sectionmark}[1]{
  \markright{\thesection.\ #1}}

\fancyhead[LE]{\bfseries\leftmark}
\fancyhead[RO]{\bfseries\rightmark}

\fancyfoot[LE,RO]{\textbf{\thepage}}
\renewcommand{\headrulewidth}{0.3pt}

\usepackage{tikz}
  \usetikzlibrary{external}
  \usetikzlibrary{
    calc,
    arrows,
    arrows.meta,
    backgrounds,
    patterns,
    shapes,
    shapes.geometric,
    positioning,
    decorations.markings,
    angles,
    intersections,
    matrix,
    fit,
    quotes,
    decorations.pathreplacing,%
    decorations.pathmorphing,%
    calligraphy,
    }

\tikzset{external/force remake}
\tikzset{external/system call={
  pdflatex \tikzexternalcheckshellescape -halt-on-error
  -interaction=batchmode -jobname "\image" "\texsource" && % or ;
  pdftops -eps "\image".pdf}}
  \tikzexternalize[prefix=Plots/cache/]
  % \tikzsetexternalprefix{Plots/Cache/}

\tikzset{>=latex}

\definecolor{p100}{HTML}{989898}
\definecolor{p90}{HTML}{808080}
\definecolor{p80}{HTML}{696969}
\definecolor{p70}{HTML}{484848}
\definecolor{p60}{HTML}{202020}
\definecolor{p50}{HTML}{000000}

\tikzstyle{style100}=[p100, solid, thick]
\tikzstyle{style90}=[p90, dashdotted, thick]
\tikzstyle{style80}=[p80, dotted, thick]
\tikzstyle{style70}=[p70, dashed, thick]
\tikzstyle{style60}=[p60, loosely dashdotted, thick]
\tikzstyle{style50}=[p50, solid, thick]

\tikzstyle{moptions}=[mark options={
  scale=1,
  fill=white,
  solid,
  }]
\tikzstyle{style1000}=[p50, dashdotted, thick, moptions, mark=square*]
\tikzstyle{style5000}=[p50, dotted, thick, moptions, mark=diamond*]
\tikzstyle{style10000}=[p50, dashed, thick, moptions, mark=triangle*]

\tikzstyle{startstop} = [
  rectangle,
  rounded corners,
  minimum width=25mm,
  text width=25mm,
  minimum height=1cm,
  text centered,
  draw=black,
  fill=red!30]

\tikzstyle{time} = [
  rectangle,
  rounded corners,
  minimum width=5mm,
  minimum height=5mm,
  text centered,
  draw=black,
  pattern=north east lines,
  pattern color=black!30,
  ]

\tikzstyle{io} = [
  trapezium,
  trapezium left angle=70,
  trapezium right angle=110,
  text width=25mm,
  minimum width=3cm,
  minimum height=1cm,
  text centered,
  draw=black,
  fill=blue!30]

\tikzstyle{process} = [
  rectangle,
  pattern=north west lines,
  pattern color=black!30,
  minimum width=25mm,
  minimum height=1cm,
  text centered,
  text width=25mm,
  draw=black]

\tikzstyle{mea} = [
  rectangle,
  minimum width=3cm,
  minimum height=1cm,
  text centered,
  text width=25mm,
  draw=black,
  fill=black!30]


\colorlet{colParticle}{black!10!}
\colorlet{colFluid}{blue!20!white}

\tikzset{
  fluid/.style = {
    fill=colFluid,
    fill opacity=.3,
    color=black,
  },
  particle/.style = {
    fill=colParticle,
    fill opacity=.3,
    color=black,
  },
  particleBall/.style = {ball color=colParticle},
}


\usepackage{pgfplots}
  % \usepgfplotslibrary{external}
  % \tikzexternalize
  \usepgfplotslibrary{groupplots}
  \usepgfplotslibrary{colormaps}
  % Define layers
  \pgfdeclarelayer{background}
  \pgfdeclarelayer{foreground}
  \pgfsetlayers{background,main,foreground}

\usepackage{tkz-euclide, tikz-cd}
\usepackage{tikz-3dplot}


\pgfplotsset{
  compat = 1.18,
  cycle list = {
    {black}, {lightgray},
    {black, densely dashed}, {lightgray, densely dashed},
    {black, dotted}, {lightgray, dotted},
    {black, loosely dotted}, {lightgray, loosely dotted}
  },
  width = 12cm,
  height = 9cm,
  every axis/.append style = {
    line width = 0.2mm,
    tick style = {line width = 0.2mm}
  },
  every axis plot/.append style = {
    line width = 0.4mm
  },
  enlarge x limits = false,
  enlarge y limits = {value = 0.05, auto},
  every axis legend/.append style = {
    nodes = right
  },
  xticklabel style={/pgf/number format/fixed},
  yticklabel style={/pgf/number format/fixed},
}

\makeatletter
\pgfplotsset{
/pgfplots/row step/.style={
/pgfplots/x filter/.append code={
        \ifnum\coordindex=0
                \def\c@pgfplots@eachnthpoint@xfilter{0}
                \edef\c@pgfplots@eachnthpoint@xfilter@cmp{#1}
        \else
                \pgfplotsutil@advancestringcounter\c@pgfplots@eachnthpoint@xfilter
                \ifx\c@pgfplots@eachnthpoint@xfilter@cmp\c@pgfplots@eachnthpoint@xfilter
                        \def\c@pgfplots@eachnthpoint@xfilter{0}
                \else
                        \let\pgfmathresult\pgfutil@empty
                \fi
        \fi
}
},
}
\makeatother
\pgfplotsset{filter discard warning=false}

